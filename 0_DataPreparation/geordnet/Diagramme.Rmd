---
title: "R Notebook"
output: html_notebook
---

alle Librariers laden
```{r}
# Create list with needed libraries
pkgs <- c("readr", "dplyr", "reticulate", "ggplot2", "Metrics","styler","tidyverse","rsample","zoo")

# Load each listed library and check if it is installed and install if necessary
for (pkg in pkgs) {
  if (!require(pkg, character.only = TRUE)) {
    install.packages(pkg)
    library(pkg, character.only = TRUE)
  }
}
```
Datenladen
```{r}
file_path <- file.path(getwd(), "data.csv")
data <- read.csv(file_path)
data$Datum <- as.Date(data$Datum, format = "%Y-%m-%d")
data$Wochentag <- as.factor(data$Wochentag)
# Train dataset (01.07.2013 to 31.07.2017)
data <- data %>%
  filter(Datum >= as.Date("2013-07-01") & Datum <= as.Date("2018-07-31"))

```
Diagramm Wochentage
```{r}
data_avg <- data %>%
  group_by(Wochentag) %>%
  summarize(mean_Umsatz = mean(Umsatz), sd_Umsatz = sd(Umsatz))

p <- ggplot(data_avg, aes(x = Wochentag, y = mean_Umsatz, fill = Wochentag)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = mean_Umsatz - sd_Umsatz, ymax = mean_Umsatz + sd_Umsatz),
                width = 0.25, position = position_dodge(0.9)) +
  labs(title = "Balkendiagramm mit Konfidenzintervallen",
       x = "Wochentag", y = "Durchschnitts-Umsatz") +
  theme_minimal()

# Das Diagramm anzeigen
print(p)


```
Diagramm Kreuzfahrtschiffe
```{r}
data_avg <- data %>%
  group_by(Kreuzfahrtschiffe) %>%
  summarize(mean_Umsatz = mean(Umsatz), sd_Umsatz = sd(Umsatz))

p <- ggplot(data_avg, aes(x = Kreuzfahrtschiffe, y = mean_Umsatz, fill = Kreuzfahrtschiffe)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = mean_Umsatz - sd_Umsatz, ymax = mean_Umsatz + sd_Umsatz),
                width = 0.25, position = position_dodge(0.9)) +
  labs(title = "Balkendiagramm mit Konfidenzintervallen",
       x = "Wochentag", y = "Durchschnitts-Umsatz") +
  theme_minimal()

# Das Diagramm anzeigen
print(p)


```

Diagramm Jahreszeiten
```{r}
data_avg <- data %>%
  group_by(Jahreszeit) %>%
  summarize(mean_Umsatz = mean(Umsatz), sd_Umsatz = sd(Umsatz))

p <- ggplot(data_avg, aes(x = Jahreszeit, y = mean_Umsatz, fill = Jahreszeit)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  geom_errorbar(aes(ymin = mean_Umsatz - sd_Umsatz, ymax = mean_Umsatz + sd_Umsatz),
                width = 0.25, position = position_dodge(0.9)) +
  labs(title = "Balkendiagramm mit Konfidenzintervallen",
       x = "Wochentag", y = "Durchschnitts-Umsatz") +
  theme_minimal()

# Das Diagramm anzeigen
print(p)
```
